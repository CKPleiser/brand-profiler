# Brand Profiler - AI-Powered Brand Style Guide Generator

A freemium NextJS application that generates comprehensive brand style guides using AI, with Stripe payments and n8n automation.

## ğŸš€ Features

- **Free Basic Guide**: AI-generated tone analysis, key traits, personality, and content direction
- **Paid Upgrades**: Core ($29) and Complete ($59) guides with detailed guidelines and AI prompts
- **Real AI Integration**: OpenAI-powered content generation via n8n workflows
- **Payment Processing**: Stripe checkout and webhook handling
- **Multi-format Downloads**: PDF, Markdown, and Text exports
- **Database Storage**: Supabase for brands, guides, and payment tracking
- **Modal Checkout**: Seamless upgrade experience without page navigation

## ğŸ› ï¸ Tech Stack

- **Frontend**: NextJS 15, TypeScript, Tailwind CSS, Shadcn UI
- **Backend**: NextJS API Routes, Stripe webhooks
- **Database**: Supabase (PostgreSQL)
- **Payments**: Stripe
- **AI Automation**: n8n + OpenAI GPT-4
- **Deployment**: Vercel

## ğŸ¤– AI Integration Overview

The Brand Profiler uses **real AI generation** for all guides:

### **Free Basic Guide**
- Generated immediately when user submits brand form
- Uses OpenAI GPT-4 via n8n webhook
- Provides genuine value with AI-powered brand analysis

### **Paid Premium Guides**
- Generated after successful Stripe payment
- **Core Guide ($29)**: Detailed guidelines with messaging pillars
- **Complete Guide ($59)**: Comprehensive brand system + AI content prompt
- All content generated by OpenAI GPT-4 with specialized prompts

## ğŸ“¦ Quick Start

1. **Clone and Install**
   ```bash
   git clone https://github.com/CKPleiser/brand-profiler.git
   cd brand-profiler
   npm install
   ```

2. **Set up Environment Variables**
   ```bash
   cp .env.example .env.local
   # Configure all required variables (see below)
   ```

3. **Run Development Server**
   ```bash
   npm run dev
   ```

4. **Set up n8n Workflows** (see [N8N Setup Guide](./N8N_SETUP.md))

## ğŸ”§ Environment Variables

Create a `.env.local` file with these variables:

```env
# Stripe Configuration
STRIPE_SECRET_KEY=sk_test_...
STRIPE_PUBLISHABLE_KEY=pk_test_...
NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY=pk_test_...
STRIPE_WEBHOOK_SECRET=whsec_...

# Supabase Configuration
SUPABASE_URL=https://your-project.supabase.co
SUPABASE_ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...

# Application Configuration
NEXT_PUBLIC_APP_URL=https://your-domain.vercel.app

# n8n Webhook URLs
N8N_WEBHOOK_URL=https://your-n8n-instance.com/webhook
```

## ğŸ’³ Stripe Setup

1. **Create Products** in Stripe Dashboard:
   - Core Guide: $29.00 USD
   - Complete Guide: $59.00 USD

2. **Update Price IDs** in `src/lib/stripe.ts`:
   ```typescript
   export const PRICING_CONFIG = {
     core: {
       price_id: 'price_1Rrv8QGsneJ9VFY05wfXqHbY', // Your actual Core price ID
       amount: 2900,
       name: 'Core Guide'
     },
     complete: {
       price_id: 'price_1Rrv8rGsneJ9VFY0C52jUlwc', // Your actual Complete price ID
       amount: 5900,
       name: 'Complete Guide'
     }
   }
   ```

3. **Configure Webhook**:
   - URL: `https://your-domain.vercel.app/api/webhook/stripe`
   - Event: `checkout.session.completed`

## ğŸ—„ï¸ Supabase Setup

1. **Create Project** at https://supabase.com
2. **Run Database Schema**:
   ```sql
   -- Copy contents from supabase-schema.sql and run in SQL Editor
   ```
3. **Copy credentials** to environment variables

## ğŸ¤– n8n + OpenAI Setup

**This is the core of the AI integration.** See detailed setup guide: [N8N_SETUP.md](./N8N_SETUP.md)

### Quick Overview:

1. **Set up n8n instance** (cloud recommended)
2. **Import workflow files**:
   - `n8n-basic-guide-workflow.json` - For free guides
   - `n8n-premium-guide-workflow.json` - For paid guides
3. **Configure OpenAI credentials** in n8n
4. **Update webhook URLs** in environment variables

### Workflow Endpoints:
- **Basic Guide**: `https://your-n8n.com/webhook/basic-guide`
- **Premium Guide**: `https://your-n8n.com/webhook/premium-guide`

## ğŸš€ Deployment

### Vercel Deployment

1. **Connect Repository** to Vercel
2. **Add Environment Variables** in Vercel dashboard
3. **Deploy** - automatic on push to main

### Post-Deployment Checklist:
- âœ… Update Stripe webhook URL to production domain
- âœ… Test payment flow with Stripe test cards
- âœ… Verify n8n webhooks are accessible
- âœ… Test AI guide generation end-to-end

## ğŸ“ Project Structure

```
src/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â”œâ”€â”€ create-checkout-session/    # Stripe checkout
â”‚   â”‚   â””â”€â”€ webhook/stripe/             # Payment webhooks
â”‚   â”œâ”€â”€ guide/
â”‚   â”‚   â”œâ”€â”€ basic/                      # Free guide + modal checkout
â”‚   â”‚   â”œâ”€â”€ preview/                    # Pricing page (fallback)
â”‚   â”‚   â”œâ”€â”€ complete/                   # Premium guide access
â”‚   â”‚   â””â”€â”€ success/                    # Post-payment
â”‚   â””â”€â”€ page.tsx                        # Landing + brand form
â”œâ”€â”€ lib/
â”‚   â”œâ”€â”€ stripe.ts                       # Stripe config
â”‚   â”œâ”€â”€ supabase.ts                     # Database client
â”‚   â””â”€â”€ guide-generator.ts              # Mock data (replaced by n8n)
â”œâ”€â”€ types/index.ts                      # TypeScript interfaces
â””â”€â”€ components/ui/                      # Shadcn components

# n8n Integration Files
â”œâ”€â”€ N8N_SETUP.md                       # Complete setup guide
â”œâ”€â”€ n8n-basic-guide-workflow.json      # Import to n8n
â”œâ”€â”€ n8n-premium-guide-workflow.json    # Import to n8n
â””â”€â”€ supabase-schema.sql                 # Database schema
```

## ğŸ§ª Testing

### Test Payment Flow
```bash
# Use Stripe test cards
# Success: 4242 4242 4242 4242
# Decline: 4000 0000 0000 0002
```

### Test AI Generation
```bash
# Test basic guide generation
curl -X POST https://your-n8n.com/webhook/basic-guide \
  -H "Content-Type: application/json" \
  -d '{
    "brandName": "Test Co",
    "domain": "https://test.com",
    "description": "Test description",
    "audience": "Test audience",
    "voiceTraits": ["Professional", "Friendly"],
    "language": "English"
  }'
```

## ğŸ¯ Key Features Explained

### **Free Basic Guide**
- **Real AI value**: Uses OpenAI to analyze brand and generate insights
- **Immediate generation**: No signup required, generated on form submission
- **Modal upgrade**: Seamless pricing modal for easy upselling

### **Premium Guides**
- **Core ($29)**: Detailed voice guidelines + messaging pillars
- **Complete ($59)**: Full brand system + AI prompt for content creation
- **Post-payment generation**: AI content created after successful payment
- **Multiple downloads**: PDF, Markdown, Text formats

### **Technical Highlights**
- **NextJS 15**: Latest features with App Router
- **TypeScript**: Full type safety
- **Stripe Integration**: Secure payment processing
- **n8n Automation**: Flexible AI workflow management
- **Supabase**: Scalable database with RLS
- **Modal UX**: No page reloads for smooth experience

## ğŸ› Troubleshooting

### Common Issues

1. **AI Generation Fails**
   - Check n8n workflow logs
   - Verify OpenAI API key and credits
   - Test webhook accessibility

2. **Payment Issues**
   - Verify Stripe price IDs match products
   - Check webhook endpoint configuration
   - Test with Stripe test cards

3. **Build Errors**
   - Ensure all environment variables are set
   - Check TypeScript types
   - Verify Suspense boundaries for useSearchParams

4. **Modal Not Working**
   - Check JavaScript console for errors
   - Verify button event handlers
   - Test with browser dev tools

## ğŸ“ˆ Performance Notes

- **AI Generation**: ~5-15 seconds depending on tier
- **Basic guides**: Cached in localStorage for reuse
- **Payment flow**: Optimized with minimal navigation
- **Error handling**: Fallback responses if AI fails

## ğŸ”’ Security Features

- **Environment variables**: All secrets properly configured
- **Stripe webhooks**: Signature verification
- **Supabase RLS**: Database security policies
- **Input validation**: Sanitized user inputs
- **Error handling**: No sensitive data in error messages

## ğŸ“ Support

For setup questions or issues:
1. Check the [n8n Setup Guide](./N8N_SETUP.md)
2. Review troubleshooting section above
3. Create an issue on GitHub

## ğŸ“„ License

MIT License - see LICENSE file for details.

---

**Ready to generate AI-powered brand guides?** Follow the setup guides and you'll have a fully functional freemium brand profiler with real AI integration! ğŸš€